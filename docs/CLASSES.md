# Структура классов проекта

## StunnelManager

Класс для управления конфигурацией stunnel и службой Windows.

### Атрибуты класса

- `SERVERS: dict` - Словарь доступных серверов {IP: описание}
- `SERVICE_NAME: str` - Имя службы Windows ("Stunnel")

### Атрибуты экземпляра

- `config_dir: Path` - Путь к директории конфигурации в AppData
- `config_file_path: str` - Путь к файлу конфигурации stunnel.conf
- `log_file: Path` - Путь к текущему файлу лога

### Методы

#### `__init__()`
Инициализация менеджера, создание директории конфигурации, загрузка настроек.

#### `_get_app_data_dir() -> Path`
Возвращает путь к директории приложения в APPDATA.

#### `_load_config_path() -> str`
Загружает сохраненный путь к конфигурационному файлу из settings.json.

#### `save_config_path(path: str)`
Сохраняет путь к конфигурационному файлу в settings.json.

#### `_create_log_file() -> Path`
Создает новый файл лога с временной меткой.

#### `log(message: str, to_file: bool = True)`
Записывает сообщение в лог и консоль.

#### `get_current_server() -> str | None`
Извлекает IP текущего сервера из конфигурационного файла.

#### `stop_service() -> bool`
Останавливает службу Stunnel (через net stop или taskkill).

#### `start_service() -> bool`
Запускает службу Stunnel.

#### `change_server(new_ip: str) -> bool`
Изменяет IP сервера в конфиге и перезапускает службу.
Последовательность:
1. Остановка службы
2. Создание резервной копии конфига
3. Изменение строки connect= в конфиге
4. Запуск службы

---

## StunnelGUI

Класс графического интерфейса на базе tkinter.

### Атрибуты экземпляра

- `root: tk.Tk` - Главное окно приложения
- `manager: StunnelManager` - Экземпляр менеджера
- `config_path_var: tk.StringVar` - Переменная для отображения пути к конфигу
- `current_server_var: tk.StringVar` - Переменная для отображения текущего сервера
- `server_var: tk.StringVar` - Переменная для выбранного сервера (радиокнопки)

### Методы

#### `__init__(root: tk.Tk)`
Инициализация GUI, создание виджетов.

#### `_create_widgets()`
Создает все элементы интерфейса:
- Заголовок
- Поле выбора файла конфигурации
- Отображение текущего сервера
- Радиокнопки выбора сервера
- Кнопки управления

#### `_browse_config()`
Открывает диалог выбора файла конфигурации.

#### `_update_current_server()`
Обновляет отображение текущего сервера.

#### `_change_server()`
Обработчик кнопки "Применить изменения", выполняет смену сервера.

#### `_open_log()`
Открывает текущий файл лога в системном редакторе.

#### `_open_log_folder()`
Открывает папку с логами в проводнике.

---

## Вспомогательные функции

### `is_admin() -> bool`
Проверяет, запущена ли программа с правами администратора.

### `run_as_admin() -> bool`
Перезапускает программу с правами администратора через ShellExecuteW.

### `main()`
Главная функция:
1. Проверка прав администратора
2. Запуск GUI
